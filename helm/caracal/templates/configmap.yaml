apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "caracal.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "caracal.labels" . | nindent 4 }}
data:
  # Database Configuration
  DB_HOST: {{ include "caracal.postgresql.host" . | quote }}
  DB_PORT: {{ .Values.postgresql.service.port | quote }}
  DB_NAME: {{ .Values.postgresql.auth.database | quote }}
  DB_USER: {{ .Values.postgresql.auth.username | quote }}
  
  # Redis Configuration
  REDIS_HOST: {{ include "caracal.redis.host" . | quote }}
  REDIS_PORT: {{ .Values.redis.service.port | quote }}
  REDIS_DB: "0"
  REDIS_SSL: "false"
  REDIS_SPENDING_CACHE_TTL: "86400"
  REDIS_METRICS_CACHE_TTL: "3600"
  
  # Merkle Tree Configuration
  MERKLE_BATCH_SIZE_LIMIT: {{ .Values.consumers.ledgerWriter.merkle.batchSizeLimit | quote }}
  MERKLE_BATCH_TIMEOUT_SECONDS: {{ .Values.consumers.ledgerWriter.merkle.batchTimeoutSeconds | quote }}
  MERKLE_SIGNING_ALGORITHM: {{ .Values.consumers.ledgerWriter.merkle.signingAlgorithm | quote }}
  MERKLE_SIGNING_KEY_PATH: "/etc/caracal/keys/merkle_signing_key.pem"
  

  
  # MCP Adapter Configuration
  MCP_ADAPTER_LISTEN_ADDRESS: "0.0.0.0:{{ .Values.mcpAdapter.service.port }}"
  MCP_SERVERS: {{ .Values.mcpAdapter.mcpServers | quote }}
  MCP_SERVER_TIMEOUT: {{ .Values.mcpAdapter.mcpServerTimeout | quote }}
  

  # Monitoring Configuration
  ENABLE_PROMETHEUS_METRICS: {{ .Values.monitoring.prometheus.enabled | quote }}
  ENABLE_STRUCTURED_LOGGING: {{ .Values.logging.structuredLogging | quote }}
