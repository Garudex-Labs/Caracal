"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4070],{1783(e,i,n){n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>d,default:()=>o,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"caracalCore/cliReference/policy","title":"Policy Commands","description":"The policy command group manages authority policies for principals.","source":"@site/docs/caracalCore/cliReference/policy.md","sourceDirName":"caracalCore/cliReference","slug":"/caracalCore/cliReference/policy","permalink":"/caracalCore/cliReference/policy","draft":false,"unlisted":false,"editUrl":"https://github.com/Garudex-Labs/Caracal/tree/main/docs/docs/caracalCore/cliReference/policy.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Policy Commands"},"sidebar":"caracalSidebar","previous":{"title":"Agent Commands","permalink":"/caracalCore/cliReference/agent"},"next":{"title":"Ledger Commands","permalink":"/caracalCore/cliReference/ledger"}}');var c=n(4848),s=n(8453);const l={sidebar_position:3,title:"Policy Commands"},d="Policy Commands",t={},a=[{value:"Commands Overview",id:"Commands-Overview",level:2},{value:"create",id:"create",level:2},{value:"Options",id:"Options",level:3},{value:"Examples",id:"Examples",level:3},{value:"list",id:"list",level:2},{value:"Options",id:"Options-1",level:3},{value:"get",id:"get",level:2},{value:"Options",id:"Options-2",level:3},{value:"history",id:"history",level:2},{value:"Options",id:"Options-3",level:3},{value:"Best Practices",id:"Best-Practices",level:2},{value:"Policy Design",id:"Policy-Design",level:3},{value:"See Also",id:"See-Also",level:2}];function h(e){const i={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Details:n}=i;return n||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.header,{children:(0,c.jsx)(i.h1,{id:"Policy-Commands",children:"Policy Commands"})}),"\n",(0,c.jsxs)(i.p,{children:["The ",(0,c.jsx)(i.code,{children:"policy"})," command group manages authority policies for principals."]}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"caracal policy COMMAND [OPTIONS]\n"})}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"Commands-Overview",children:"Commands Overview"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Command"}),(0,c.jsx)(i.th,{children:"Description"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.a,{href:"#create",children:(0,c.jsx)(i.code,{children:"create"})})}),(0,c.jsx)(i.td,{children:"Create a new authority policy"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.a,{href:"#list",children:(0,c.jsx)(i.code,{children:"list"})})}),(0,c.jsx)(i.td,{children:"List all policies"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.a,{href:"#get",children:(0,c.jsx)(i.code,{children:"get"})})}),(0,c.jsx)(i.td,{children:"Get policy details"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.a,{href:"#history",children:(0,c.jsx)(i.code,{children:"history"})})}),(0,c.jsx)(i.td,{children:"View policy change history"})]})]})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"create",children:"create"}),"\n",(0,c.jsx)(i.p,{children:"Create a new authority policy for a principal."}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"caracal policy create [OPTIONS]\n"})}),"\n",(0,c.jsx)(i.h3,{id:"Options",children:"Options"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Option"}),(0,c.jsx)(i.th,{children:"Short"}),(0,c.jsx)(i.th,{style:{textAlign:"center"},children:"Required"}),(0,c.jsx)(i.th,{children:"Default"}),(0,c.jsx)(i.th,{children:"Description"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--agent-id"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-a"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"Yes"}),(0,c.jsx)(i.td,{children:"-"}),(0,c.jsx)(i.td,{children:"Principal ID this policy applies to"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--resources"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-r"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"Yes"}),(0,c.jsx)(i.td,{children:"-"}),(0,c.jsx)(i.td,{children:"Allowed resource patterns (supports wildcards)"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--actions"})}),(0,c.jsx)(i.td,{}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"Yes"}),(0,c.jsx)(i.td,{children:"-"}),(0,c.jsx)(i.td,{children:"Allowed actions (read, write, execute)"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--max-validity"})}),(0,c.jsx)(i.td,{}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"86400"}),(0,c.jsx)(i.td,{children:"Maximum mandate validity in seconds"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--delegation-depth"})}),(0,c.jsx)(i.td,{}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"0"}),(0,c.jsx)(i.td,{children:"Maximum delegation chain depth"})]})]})]}),"\n",(0,c.jsx)(i.h3,{id:"Examples",children:"Examples"}),"\n",(0,c.jsxs)(n,{children:[(0,c.jsx)("summary",{children:"Basic policy"}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-bash",children:'caracal policy create \\\n  --agent-id 550e8400-e29b-41d4-a716-446655440000 \\\n  --resources "api:external/*" \\\n  --actions "read" "write" \\\n  --max-validity 86400\n'})}),(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Output:"})}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"Policy created successfully!\n\nPolicy ID:         pol-001-aaaa-bbbb-cccc\nPrincipal ID:      550e8400-e29b-41d4-a716-446655440000\nResources:         api:external/*\nActions:           read, write\nMax Validity:      86400s (24h)\nDelegation Depth:  0\nCreated At:        2024-01-15T10:00:00Z\n"})})]}),"\n",(0,c.jsxs)(n,{children:[(0,c.jsx)("summary",{children:"Policy with delegation"}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-bash",children:'caracal policy create \\\n  --agent-id 550e8400-e29b-41d4-a716-446655440000 \\\n  --resources "api:external/*" "db:analytics/*" \\\n  --actions "read" "write" "execute" \\\n  --max-validity 3600 \\\n  --delegation-depth 2\n'})}),(0,c.jsx)(i.p,{children:"This policy allows the principal to delegate authority up to 2 levels deep."})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"list",children:"list"}),"\n",(0,c.jsx)(i.p,{children:"List all policies."}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"caracal policy list [OPTIONS]\n"})}),"\n",(0,c.jsx)(i.h3,{id:"Options-1",children:"Options"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Option"}),(0,c.jsx)(i.th,{children:"Short"}),(0,c.jsx)(i.th,{children:"Default"}),(0,c.jsx)(i.th,{children:"Description"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--agent-id"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-a"})}),(0,c.jsx)(i.td,{children:"-"}),(0,c.jsx)(i.td,{children:"Filter by principal ID"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--format"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-f"})}),(0,c.jsx)(i.td,{children:"table"}),(0,c.jsx)(i.td,{children:"Output format: table or json"})]})]})]}),"\n",(0,c.jsxs)(n,{children:[(0,c.jsx)("summary",{children:"List all policies"}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-bash",children:"caracal policy list\n"})}),(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Output:"})}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"Policy ID                             Principal          Resources           Actions      Max Validity\n---------------------------------------------------------------------------------------------------------\npol-001-aaaa-bbbb-cccc                orchestrator       api:external/*      read,write   86400s\npol-002-aaaa-bbbb-cccc                worker-1           api:external/sub    read         3600s\n"})})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"get",children:"get"}),"\n",(0,c.jsx)(i.p,{children:"Get details for a specific policy."}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"caracal policy get [OPTIONS]\n"})}),"\n",(0,c.jsx)(i.h3,{id:"Options-2",children:"Options"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Option"}),(0,c.jsx)(i.th,{children:"Short"}),(0,c.jsx)(i.th,{style:{textAlign:"center"},children:"Required"}),(0,c.jsx)(i.th,{children:"Description"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--policy-id"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-p"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"Yes"}),(0,c.jsx)(i.td,{children:"Policy ID"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--format"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-f"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"Output format: table or json"})]})]})]}),"\n",(0,c.jsxs)(n,{children:[(0,c.jsx)("summary",{children:"Get policy details"}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-bash",children:"caracal policy get --policy-id pol-001-aaaa-bbbb-cccc\n"})}),(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Output:"})}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"Policy Details\n==============\n\nPolicy ID:         pol-001-aaaa-bbbb-cccc\nPrincipal ID:      550e8400-e29b-41d4-a716-446655440000\nPrincipal Name:    orchestrator\nResources:         api:external/*\nActions:           read, write\nMax Validity:      86400s (24h)\nDelegation Depth:  0\nCreated At:        2024-01-15T10:00:00Z\nVersion:           1\n"})})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"history",children:"history"}),"\n",(0,c.jsx)(i.p,{children:"View policy change history."}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"caracal policy history [OPTIONS]\n"})}),"\n",(0,c.jsxs)(i.blockquote,{children:["\n",(0,c.jsx)(i.p,{children:"Note: Requires database backend."}),"\n"]}),"\n",(0,c.jsx)(i.h3,{id:"Options-3",children:"Options"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Option"}),(0,c.jsx)(i.th,{children:"Short"}),(0,c.jsx)(i.th,{style:{textAlign:"center"},children:"Required"}),(0,c.jsx)(i.th,{children:"Description"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--policy-id"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-p"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"Yes"}),(0,c.jsx)(i.td,{children:"Policy ID"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--start-time"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-s"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"Start time (ISO 8601)"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--end-time"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-e"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"End time (ISO 8601)"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"--format"})}),(0,c.jsx)(i.td,{children:(0,c.jsx)(i.code,{children:"-f"})}),(0,c.jsx)(i.td,{style:{textAlign:"center"},children:"No"}),(0,c.jsx)(i.td,{children:"Output format"})]})]})]}),"\n",(0,c.jsxs)(n,{children:[(0,c.jsx)("summary",{children:"View full history"}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{className:"language-bash",children:"caracal policy history --policy-id pol-001-aaaa-bbbb-cccc\n"})}),(0,c.jsx)(i.p,{children:(0,c.jsx)(i.strong,{children:"Output:"})}),(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"Policy History: pol-001-aaaa-bbbb-cccc\n======================================\n\nVersion  Change Type     Changed At              Changed By       Details\n----------------------------------------------------------------------------------\n2        scope_changed   2024-01-20T14:30:00Z    admin           Added db:* resources\n1        created         2024-01-01T10:00:00Z    admin           Initial policy\n"})})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"Best-Practices",children:"Best Practices"}),"\n",(0,c.jsx)(i.h3,{id:"Policy-Design",children:"Policy Design"}),"\n",(0,c.jsxs)(i.table,{children:[(0,c.jsx)(i.thead,{children:(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.th,{children:"Scenario"}),(0,c.jsx)(i.th,{children:"Recommended Setup"})]})}),(0,c.jsxs)(i.tbody,{children:[(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:"Read-only agent"}),(0,c.jsxs)(i.td,{children:[(0,c.jsx)(i.code,{children:"actions=read"}),", narrow resource scope"]})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:"Full-access orchestrator"}),(0,c.jsx)(i.td,{children:"Broad resource scope, delegation enabled"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:"Scoped worker"}),(0,c.jsx)(i.td,{children:"Narrow resource scope, short max validity"})]}),(0,c.jsxs)(i.tr,{children:[(0,c.jsx)(i.td,{children:"Audit-safe"}),(0,c.jsx)(i.td,{children:"No delegation depth, short validity windows"})]})]})]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"See-Also",children:"See Also"}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"./agent",children:"Agent Commands"})," -- Register principals"]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"./delegation",children:"Delegation Commands"})," -- Manage authority delegation"]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.a,{href:"./ledger",children:"Ledger Commands"})," -- Query authority events"]}),"\n"]})]})}function o(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,c.jsx)(i,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},8453(e,i,n){n.d(i,{R:()=>l,x:()=>d});var r=n(6540);const c={},s=r.createContext(c);function l(e){const i=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:l(e.components),r.createElement(s.Provider,{value:i},e.children)}}}]);