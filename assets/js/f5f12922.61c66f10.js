"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[784],{8546(e,r,n){n.r(r),n.d(r,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"caracalCore/apiReference/mcpIntegration","title":"MCP Adapter for Caracal Core","description":"This module provides integration between Caracal authority enforcement and the Model Context Protocol (MCP) ecosystem.","source":"@site/docs/caracalCore/apiReference/mcpIntegration.md","sourceDirName":"caracalCore/apiReference","slug":"/caracalCore/apiReference/mcpIntegration","permalink":"/caracalCore/apiReference/mcpIntegration","draft":false,"unlisted":false,"editUrl":"https://github.com/Garudex-Labs/Caracal/tree/main/docs/docs/caracalCore/apiReference/mcpIntegration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"caracalSidebar","previous":{"title":"SDK Client","permalink":"/caracalCore/apiReference/sdkClient"},"next":{"title":"MCP Adapter Decorator -- SDK Plugin Mode","permalink":"/caracalCore/apiReference/mcpDecorators"}}');var o=n(4848),i=n(8453);const a={},c="MCP Adapter for Caracal Core",l={},s=[{value:"Overview",id:"Overview",level:2},{value:"Components",id:"Components",level:2},{value:"MCPAdapter",id:"MCPAdapter",level:3},{value:"MCPContext",id:"MCPContext",level:3},{value:"MCPResult",id:"MCPResult",level:3},{value:"MCPResource",id:"MCPResource",level:3},{value:"Usage Example",id:"Usage-Example",level:2},{value:"Resource Registration",id:"Resource-Registration",level:2},{value:"Architecture",id:"Architecture",level:2},{value:"Error Handling",id:"Error-Handling",level:2},{value:"Logging",id:"Logging",level:2},{value:"See Also",id:"See-Also",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"MCP-Adapter-for-Caracal-Core",children:"MCP Adapter for Caracal Core"})}),"\n",(0,o.jsx)(r.p,{children:"This module provides integration between Caracal authority enforcement and the Model Context Protocol (MCP) ecosystem."}),"\n",(0,o.jsx)(r.h2,{id:"Overview",children:"Overview"}),"\n",(0,o.jsx)(r.p,{children:"The MCP Adapter intercepts MCP tool calls and resource reads, enforces authority policies, and records authority events. This enables mandate-based enforcement for MCP-based agents."}),"\n",(0,o.jsx)(r.h2,{id:"Components",children:"Components"}),"\n",(0,o.jsx)(r.h3,{id:"MCPAdapter",children:"MCPAdapter"}),"\n",(0,o.jsx)(r.p,{children:"Main adapter class that coordinates authority enforcement for MCP operations."}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"Key Methods:"})}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"intercept_tool_call()"}),": Intercepts MCP tool invocations, validates mandates, forwards to MCP server, and records authority events"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.code,{children:"intercept_resource_read()"}),": Intercepts MCP resource reads, validates mandates, fetches resource, and records authority events"]}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"MCPContext",children:"MCPContext"}),"\n",(0,o.jsx)(r.p,{children:"Context information for MCP requests containing principal ID and metadata."}),"\n",(0,o.jsx)(r.h3,{id:"MCPResult",children:"MCPResult"}),"\n",(0,o.jsx)(r.p,{children:"Result of an MCP operation with success status, result data, and metadata."}),"\n",(0,o.jsx)(r.h3,{id:"MCPResource",children:"MCPResource"}),"\n",(0,o.jsx)(r.p,{children:"Represents an MCP resource with URI, content, MIME type, and size."}),"\n",(0,o.jsx)(r.h2,{id:"Usage-Example",children:"Usage Example"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:'from caracal.mcp import MCPAdapter, MCPContext\nfrom caracal.core.authority import AuthorityEnforcer\nfrom caracal.core.ledger import LedgerWriter\n\n# Initialize components\nauthority_enforcer = AuthorityEnforcer(policy_store)\nledger_writer = LedgerWriter(db_connection)\n\n# Create MCP adapter\nadapter = MCPAdapter(\n    authority_enforcer=authority_enforcer,\n    ledger_writer=ledger_writer\n)\n\n# Intercept tool call\ncontext = MCPContext(\n    principal_id="principal-uuid",\n    metadata={"source": "mcp-client"}\n)\n\nresult = await adapter.intercept_tool_call(\n    tool_name="llm_completion",\n    tool_args={\n        "prompt": "Hello, world!",\n        "max_tokens": 100,\n        "model": "gpt-4"\n    },\n    mcp_context=context\n)\n\nif result.success:\n    print(f"Tool result: {result.result}")\nelse:\n    print(f"Error: {result.error}")\n'})}),"\n",(0,o.jsx)(r.h2,{id:"Resource-Registration",children:"Resource Registration"}),"\n",(0,o.jsx)(r.p,{children:"Register MCP resources in the resource registry for use in policies:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"api:mcp/tool.default\napi:mcp/resource.default\napi:mcp/llm.gpt-4\napi:mcp/llm.claude-3\napi:mcp/file.read\n"})}),"\n",(0,o.jsx)(r.h2,{id:"Architecture",children:"Architecture"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{children:"+------------------+\n|   MCP Client     |\n+--------+---------+\n         |\n         v\n+------------------+\n|   MCPAdapter     |<------+\n+--------+---------+       |\n         |                 |\n         +--------+--------+--\x3e AuthorityEnforcer (mandate check)\n         |                 |\n         +--------+--------+--\x3e MCP Server (tool execution)\n         |                 |\n         +--------+--------+--\x3e LedgerWriter (record event)\n"})}),"\n",(0,o.jsx)(r.h2,{id:"Error-Handling",children:"Error Handling"}),"\n",(0,o.jsx)(r.p,{children:"The adapter implements fail-closed semantics:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:["Missing mandate raises ",(0,o.jsx)(r.code,{children:"AuthorityDeniedError"})]}),"\n",(0,o.jsxs)(r.li,{children:["Missing principal ID raises ",(0,o.jsx)(r.code,{children:"CaracalError"})]}),"\n",(0,o.jsxs)(r.li,{children:["Other errors return ",(0,o.jsx)(r.code,{children:"MCPResult"})," with ",(0,o.jsx)(r.code,{children:"success=False"})," and error message"]}),"\n",(0,o.jsx)(r.li,{children:"Authority events are recorded for both allowed and denied operations"}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"Logging",children:"Logging"}),"\n",(0,o.jsx)(r.p,{children:"The adapter logs:"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"Tool call interceptions (DEBUG)"}),"\n",(0,o.jsx)(r.li,{children:"Resource read interceptions (DEBUG)"}),"\n",(0,o.jsx)(r.li,{children:"Authority check results (INFO)"}),"\n",(0,o.jsx)(r.li,{children:"Ledger events (INFO)"}),"\n",(0,o.jsx)(r.li,{children:"Errors (ERROR)"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-python",children:'import logging\nlogging.getLogger("caracal.mcp").setLevel(logging.DEBUG)\n'})}),"\n",(0,o.jsx)(r.h2,{id:"See-Also",children:"See Also"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.a,{href:"./mcpDecorators",children:"MCP Decorator Mode"})," -- SDK plugin mode"]}),"\n",(0,o.jsxs)(r.li,{children:[(0,o.jsx)(r.a,{href:"./sdkClient",children:"SDK Client"})," -- Authority enforcement SDK"]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453(e,r,n){n.d(r,{R:()=>a,x:()=>c});var t=n(6540);const o={},i=t.createContext(o);function a(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);