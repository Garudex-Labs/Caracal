# Caracal Gateway Proxy - Environment Variables Example
# Copy this file to .env and customize for your deployment
#
# Usage with docker-compose:
#   cp .env.gateway.example .env
#   # Edit .env with your values
#   docker-compose -f docker-compose.gateway.yml up -d

# ============================================================================
# Database Configuration
# ============================================================================

# PostgreSQL password (REQUIRED - change this!)
DB_PASSWORD=caracal_dev_password

# Database connection settings
DB_PORT=5432
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=5
DB_POOL_TIMEOUT=30

# ============================================================================
# Gateway Configuration
# ============================================================================

# Gateway listen port (exposed to host)
GATEWAY_PORT=8443

# Metrics port (Prometheus)
METRICS_PORT=9090

# Authentication mode: jwt, api_key, or mtls
AUTH_MODE=jwt

# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Request timeout in seconds
REQUEST_TIMEOUT=30

# Maximum request size in MB
MAX_REQUEST_SIZE_MB=10

# ============================================================================
# JWT Configuration (when AUTH_MODE=jwt)
# ============================================================================

# JWT signature algorithm: RS256, ES256
JWT_ALGORITHM=RS256

# ============================================================================
# Replay Protection
# ============================================================================

# Enable replay protection
ENABLE_REPLAY_PROTECTION=true

# Nonce cache TTL in seconds (5 minutes)
NONCE_CACHE_TTL=300

# Maximum nonce cache size
NONCE_CACHE_SIZE=100000

# Timestamp window in seconds (5 minutes)
TIMESTAMP_WINDOW=300

# ============================================================================
# Policy Cache (Degraded Mode)
# ============================================================================

# Enable policy cache for degraded mode operation
ENABLE_POLICY_CACHE=true

# Policy cache TTL in seconds (1 minute)
POLICY_CACHE_TTL=60

# Maximum number of cached policies
POLICY_CACHE_MAX_SIZE=10000

# ============================================================================
# Provisional Charges
# ============================================================================

# Default provisional charge expiration in seconds (5 minutes)
PROVISIONAL_CHARGE_EXPIRATION=300

# Maximum provisional charge timeout in minutes (1 hour)
PROVISIONAL_CHARGE_MAX_TIMEOUT=60

# Cleanup job interval in seconds (1 minute)
PROVISIONAL_CHARGE_CLEANUP_INTERVAL=60

# Cleanup batch size (max charges to process per run)
PROVISIONAL_CHARGE_CLEANUP_BATCH_SIZE=1000
